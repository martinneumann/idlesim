/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};function e(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}function i(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function n(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function r(t,e){for(var i=0,n=e.length,r=t.length;i<n;i++,r++)t[r]=e[i];return t}function o(t){return"function"==typeof t}Object.create,Object.create;var s,a=((s=function(t){var e;e=this,Error.call(e),e.stack=(new Error).stack,this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}).prototype=Object.create(Error.prototype),s.prototype.constructor=s,s);function c(t,e){if(t){var i=t.indexOf(e);0<=i&&t.splice(i,1)}}var h=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}var e;return t.prototype.unsubscribe=function(){var t,e,s,c,h;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var d=i(l),p=d.next();!p.done;p=d.next())p.value.remove(this)}catch(e){t={error:e}}finally{try{p&&!p.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}else l.remove(this);var f=this.initialTeardown;if(o(f))try{f()}catch(t){h=t instanceof a?t.errors:[t]}var y=this._teardowns;if(y){this._teardowns=null;try{for(var b=i(y),v=b.next();!v.done;v=b.next()){var g=v.value;try{u(g)}catch(t){h=null!=h?h:[],t instanceof a?h=r(r([],n(h)),n(t.errors)):h.push(t)}}}catch(t){s={error:t}}finally{try{v&&!v.done&&(c=b.return)&&c.call(b)}finally{if(s)throw s.error}}}if(h)throw new a(h)}},t.prototype.add=function(e){var i;if(e&&e!==this)if(this.closed)u(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(i=this._teardowns)&&void 0!==i?i:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&c(e,t)},t.prototype.remove=function(e){var i=this._teardowns;i&&c(i,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function l(t){return t instanceof h||t&&"closed"in t&&o(t.remove)&&o(t.add)&&o(t.unsubscribe)}function u(t){o(t)?t():t.unsubscribe()}h.EMPTY;var d=null,p=null,f=void 0,y=!1,b=!1,v={setTimeout:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=v.delegate;return((null==i?void 0:i.setTimeout)||setTimeout).apply(void 0,r([],n(t)))},clearTimeout:function(t){var e=v.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function g(t){v.setTimeout((function(){if(!d)throw t;d(t)}))}function m(){}var w=_("C",void 0,void 0);function _(t,e,i){return{kind:t,value:e,error:i}}var k=function(t){function i(e){var i=t.call(this)||this;return i.isStopped=!1,e?(i.destination=e,l(e)&&e.add(i)):i.destination=T,i}return e(i,t),i.create=function(t,e,i){return new x(t,e,i)},i.prototype.next=function(t){this.isStopped?S(function(t){return _("N",t,void 0)}(t),this):this._next(t)},i.prototype.error=function(t){this.isStopped?S(_("E",void 0,t),this):(this.isStopped=!0,this._error(t))},i.prototype.complete=function(){this.isStopped?S(w,this):(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},i.prototype._next=function(t){this.destination.next(t)},i.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},i.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},i}(h),x=function(t){function i(e,i,n){var r,s=t.call(this)||this;if(o(e))r=e;else if(e){var a;r=e.next,i=e.error,n=e.complete,s&&b?(a=Object.create(e)).unsubscribe=function(){return s.unsubscribe()}:a=e,r=null==r?void 0:r.bind(a),i=null==i?void 0:i.bind(a),n=null==n?void 0:n.bind(a)}return s.destination={next:r?M(r,s):m,error:M(null!=i?i:$,s),complete:n?M(n,s):m},s}return e(i,t),i}(k);function M(t,e){return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];try{t.apply(void 0,r([],n(i)))}catch(t){if(y){if(!e._syncErrorHack_isSubscribing)throw t;e.__syncError=t}else g(t)}}}function $(t){throw t}function S(t,e){var i=p;i&&v.setTimeout((function(){return i(t,e)}))}var T={closed:!0,next:m,error:$,complete:m},j="function"==typeof Symbol&&Symbol.observable||"@@observable";function z(t){return t}function E(t){return 0===t.length?z:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var A=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var i=new t;return i.source=this,i.operator=e,i},t.prototype.subscribe=function(t,e,i){var n,r=(n=t)&&n instanceof k||function(t){return t&&o(t.next)&&o(t.error)&&o(t.complete)}(n)&&l(n)?t:new x(t,e,i);if(y)this._deprecatedSyncErrorSubscribe(r);else{var s=this.operator,a=this.source;r.add(s?s.call(r,a):a?this._subscribe(r):this._trySubscribe(r))}return r},t.prototype._deprecatedSyncErrorSubscribe=function(t){var e=t;e._syncErrorHack_isSubscribing=!0;var i=this.operator;if(i)t.add(i.call(t,this.source));else try{t.add(this._subscribe(t))}catch(t){e.__syncError=t}for(var n=e;n;){if("__syncError"in n)try{throw n.__syncError}finally{t.unsubscribe()}n=n.destination}e._syncErrorHack_isSubscribing=!1},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var i=this;return new(e=I(e))((function(e,n){var r;r=i.subscribe((function(e){try{t(e)}catch(t){n(t),null==r||r.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[j]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length?E(t)(this):this},t.prototype.toPromise=function(t){var e=this;return new(t=I(t))((function(t,i){var n;e.subscribe((function(t){return n=t}),(function(t){return i(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function I(t){var e;return null!==(e=null!=t?t:f)&&void 0!==e?e:Promise}var P,O=function(t){function i(e,i){return t.call(this)||this}return e(i,t),i.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},i}(h),q={setInterval:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=q.delegate;return((null==i?void 0:i.setInterval)||setInterval).apply(void 0,r([],n(t)))},clearInterval:function(t){var e=q.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},C=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.scheduler=e,n.work=i,n.pending=!1,n}return e(i,t),i.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},i.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),q.setInterval(t.flush.bind(t,this),i)},i.prototype.recycleAsyncId=function(t,e,i){if(void 0===i&&(i=0),null!=i&&this.delay===i&&!1===this.pending)return e;q.clearInterval(e)},i.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(t,e){var i,n=!1;try{this.work(t)}catch(t){n=!0,i=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),i},i.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,i=this.scheduler,n=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,c(n,this),null!=e&&(this.id=this.recycleAsyncId(i,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},i}(O),D={now:function(){return(D.delegate||Date).now()},delegate:void 0},H=function(){function t(e,i){void 0===i&&(i=t.now),this.schedulerActionCtor=e,this.now=i}return t.prototype.schedule=function(t,e,i){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(i,e)},t.now=D.now,t}(),N=new(function(t){function i(e,i){void 0===i&&(i=H.now);var n=t.call(this,e,i)||this;return n.actions=[],n._active=!1,n._scheduled=void 0,n}return e(i,t),i.prototype.flush=function(t){var e=this.actions;if(this._active)e.push(t);else{var i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}},i}(H))(C);!function(t){let e;!function(t){t[t.idle=1]="idle",t[t.walk=2]="walk",t[t.eat=3]="eat",t[t.converse=4]="converse",t[t.drink=5]="drink",t[t.pick_up=6]="pick_up",t[t.fell=7]="fell",t[t.build=8]="build",t[t.marry=9]="marry",t[t.bear_child=10]="bear_child",t[t.sleep=11]="sleep",t[t.search=12]="search"}(e||(e={}));const i=["water","wine","beer","whiskey","rum","gin","tequila","liquor","bourbon","brandy","schnapps","absinthe","champagne","cognac","vodka","whiskey","scotch","coffee","milk","water","orange juice","apple juice","lemonade","soda","beer"],n=["apple","banana","orange","peach","pear","plum","strawberry","blueberry","raspberry","blackberry","cranberry","grapefruit","apricot","mango","nectarine","pomegranate","peach","nectarine","pomegranate","cherry","persimmon","date","fig","tangerine","lemon","lime","coconut"];let r;function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function a(){let t="aeiouäöüeë",e="bcdfghjklmnpqrstvwxyz",i="",n="";for(let n=0;n<Math.floor(10*Math.random())+1;n++)(Math.floor(2*Math.random())+1)%2==0?i+=t[Math.floor(Math.random()*t.length)]:i+=e[Math.floor(Math.random()*e.length)];for(let i=0;i<Math.floor(15*Math.random())+4;i++)(Math.floor(2*Math.random())+1)%2==0?n+=t[Math.floor(Math.random()*t.length)]:n+=e[Math.floor(Math.random()*e.length)];return i=s(i),n=s(n),i+" "+n}function c(t){return h(0,100)<t}function h(t,e){return Math.floor(Math.random()*(e-t))+t}function l(t,e,i){return Math.abs(t.x-e.x)<=i&&Math.abs(t.y-e.y)<=i&&Math.abs(t.z-e.z)<=i}function u(){return{x:h(0,y.width),y:h(0,y.height),z:h(0,y.z_depth)}}!function(t){t[t.edible=1]="edible",t[t.drinkable=2]="drinkable",t[t.poisoned=3]="poisoned",t[t.weapon=4]="weapon",t[t.building_material=5]="building_material"}(r||(r={}));class d{constructor(){this.perception=30,this.speed=50,this.reach=5}}class p{constructor(t,i,n){this.name="Unnamed Person",this.skills=new d,this.age=0,this.position={x:1,y:1,z:1},this.hunger=0,this.thirst=0,this.relationships=[],this.inventory=[],this.memory=[],this.current_perceptions=[],this.intention=e.idle,this.current_action=e.idle,this.name=t,this.birthday=i,this.position=n,console.log(`A person by the name of ${this.name} now exists.`)}body_functions(t){return this.hunger>=100?(console.log(`${this.name} died of starvation.`),!1):this.thirst>=100?(console.log(`${this.name} died of thirst.`),!1):(console.log(`${this.name} lost ${t} energy.`),this.hunger+=t,this.thirst+=t,!0)}print_intention(){console.log(`${this.name} wants to ${this.intention}.`)}decide(){return this.thirst>50?(console.log(`${this.name} is thirsty.`),void(this.intention=e.drink)):this.hunger>50?(console.log(`${this.name} is hungry.`),void(this.intention=e.eat)):void(this.intention=e.idle)}pick_up(t){""!=t.belongsTo?console.log(`${this.name} tried to pick up ${t.name} from ${t.belongsTo}... but decided not to steal.`):(t.belongsTo=this.name,this.inventory.push(t),y.objects.splice(y.objects.indexOf(t),1),console.log(`${this.name} picked up ${t.name}.`))}perceive(t){this.current_perceptions=Array(),this.current_perceptions=function(t,e){let i=[];for(let n=0;n<y.objects.length;n++){let r=y.objects[n];Math.sqrt(Math.pow(r.position.x-t.x,2)+Math.pow(r.position.y-t.y,2)+Math.pow(r.position.z-t.z,2))<e&&i.push(r)}return i}(this.position,t)}get_status(){console.log(`${this.name} is ${this.hunger}% hungry and ${this.thirst}% thirsty.`)}move_towards(t,e){let i=Math.sqrt(Math.pow(this.position.x-t.x,2)+Math.pow(this.position.y-t.y,2)+Math.pow(this.position.z-t.z,2)),n={x:this.position.x-t.x,y:this.position.y-t.y,z:this.position.z-t.z},r=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2)+Math.pow(n.z,2)),o=n.x/r,s=n.y/r,a=n.z/r;if(i<e)this.position=t;else{let t={x:this.position.x+o*this.skills.speed,y:this.position.y+s*this.skills.speed,z:this.position.z+a*this.skills.speed};this.position=t}}do_action(){switch(this.intention){case e.idle:console.log(`${this.name} decides to do nothing in particular for a while.`);break;case e.drink:let t=this.inventory.find((t=>t.descriptors.find((t=>t===r.drinkable))));if(t){this.thirst-=60,console.log(`${this.name} drinks the ${t.name}.`),this.inventory.splice(this.inventory.findIndex((e=>e==t)),1);break}{let t=this.current_perceptions.find((t=>t.descriptors.find((t=>t===r.drinkable))&&""==t.belongsTo));if(t){if(l(t.position,this.position,this.skills.reach)){this.pick_up(t);break}console.log(`${this.name} is walking towards a ${t.name}`),this.move_towards(t.position,this.skills.speed);break}console.log(`${this.name} is trying to find something to drink.`),this.move_towards(u(),this.skills.speed);break}case e.eat:let i=this.inventory.find((t=>t.descriptors.find((t=>t===r.edible))));if(i){this.hunger-=60,console.log(`${this.name} eats the ${i.name}.`),this.inventory.splice(this.inventory.findIndex((t=>t==i)),1);break}{let t=this.current_perceptions.find((t=>t.descriptors.find((t=>t===r.edible))&&""==t.belongsTo));if(t){if(l(t.position,this.position,this.skills.reach)){this.pick_up(t);break}console.log(`${this.name} is walking towards a ${t.name}`),this.move_towards(t.position,this.skills.speed);break}console.log(`${this.name} is trying to find something to eat.`),this.move_towards(u(),this.skills.speed);break}case e.walk:case e.converse:case e.pick_up:case e.build:case e.bear_child:case e.marry:}return this.body_functions(1)}}class f{constructor(t,e,i,n){this.name="",this.descriptors=[],this.position={x:1,y:1,z:1},this.belongsTo="",this.name=t,this.descriptors=e,this.position=i,this.belongsTo=n}}const y=new class{constructor(){this.width=100,this.height=100,this.z_depth=100,this.people=[],this.objects=[],this.plants=[],this.name=a(),console.log(`Somewhere, a world created itself. It is called ${this.name} by those who inhabit it.`);for(let t=0;t<h(10,30);t++)this.people.push(new p(a(),new Date(Date.now()),{x:h(0,this.width),y:h(0,this.height),z:0}));this.simulation_loop()}simulation_loop(){console.log("Time has started to affect the world.");const t=function(t,e,i){void 0===t&&(t=0),void 0===i&&(i=N);var n,r=-1;return null!=e&&((n=e)&&o(n.schedule)?i=e:r=e),new A((function(e){var n=function(t){return t instanceof Date&&!isNaN(t)}(t)?+t-i.now():t;n<0&&(n=0);var o=0;return i.schedule((function(){e.closed||(e.next(o++),0<=r?this.schedule(void 0,r):e.complete())}),n)}))}(1e3,1e3).subscribe((()=>{if(this.people.forEach((t=>{t.perceive(t.skills.perception),t.decide(),t.do_action()||(console.log(`${t.name} has been found dead.`),this.people.splice(this.people.findIndex((e=>e==t)),1))})),this.objects.length<200){for(let t=0;t<h(1,15);t++)c(50)&&this.objects.push(new f(i[h(0,i.length)],[r.drinkable],{x:h(0,this.width),y:h(0,this.height),z:0},""));for(let t=0;t<h(1,15);t++)c(50)&&this.objects.push(new f(n[h(0,n.length)],[r.edible],{x:h(0,this.width),y:h(0,this.height),z:0},""))}else console.log(`The world is full of objects, ${this.objects.length} in total.`);if(console.log(`The world has ${this.people.length} people in it.`),0===this.people.length)return console.log("The world has no more people in it."),console.log("The world has ended."),void t.unsubscribe();console.log("Another hour has passed.")}))}}}(P||(P={}))})();